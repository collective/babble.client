<tal:get define="portlet_id view/get_id">
<tal:script replace="structure string: 
<script type='text/javascript'>
    jQuery(document).ready(function(){
        doc_title = document.title;
        jQuery([window, document]).blur(function(){
            window_focus = false;
        }).focus(function(){
            window_focus = true;
            document.title = doc_title;
        });
        jQuery('dl#$portlet_id div#$portlet_id-contacts dd').quicksearch({
            position: 'prepend',
            attached: 'dl#$portlet_id dd#$portlet_id-footer',
            loaderText: '',
            delay: 100
        })
    });
</script>"/>

<dl class="portlet online-contacts" 
    tal:attributes="id portlet_id"
    i18n:domain="slc.onlinecontacts">
    <dt class="portletHeader">
        <span tal:replace="view/title">Who's online?</span>
    </dt>

    <metal:macro define-macro="current-online-contacts">
        <div id="online-contacts"
            tal:define="contacts view/get_online_members"
            tal:attributes="class python:contacts > 5 and 'online-contacts-max' or 'online-contacts';
            id string:$portlet_id-contacts">
        <tal:items tal:repeat="contact contacts">
            <dd class="portletItem"
                tal:define="oddrow repeat/contact/odd;
                            fullname python:contact.getProperty('fullname') or contact.id"
                tal:attributes="class python:oddrow and  'portletItem even' or 'portletItem odd'">
                <a  tal:content="fullname" 
                    style="cursor: pointer;"
                    tal:attributes="onclick string:jQuery.noConflict();; startChat('${contact/id}')"> 
                    Contact Name 
                </a>
            </dd>
        </tal:items>
    </div>
    </metal:macro>
    <dd class="portletFooter" tal:attributes="id string:$portlet_id-footer"></dd>
</dl>
</tal:get>
